version: "3.7"

services:
  fuzzysearch:
    image: 461183108257.dkr.ecr.eu-west-2.amazonaws.com/uec-dos-api/sfs/dos-service-fuzzy-search-api:latest
    container_name: fuzzysearch
    environment:
      SPRING_PROFILES_ACTIVE: $SPRING_PROFILES_ACTIVE
      URL: $URL
      SERVER_PORT: $SERVER_PORT
      VERSION: $VERSION
      MIN_SEARCH_TERM_LENGTH: $MIN_SEARCH_TERM_LENGTH
      MAX_SEARCH_CRITERIA: $MAX_SEARCH_CRITERIA
      MAX_NUM_SERVICES_TO_RETURN: $MAX_NUM_SERVICES_TO_RETURN
    ports:
      - 9095:9095
    command: ["java", "-jar", "/application/dos-service-fuzzy-search-api.jar"]
    networks:
      default:
        aliases:
          - fuzzysearch.sfs.local

  elasticsearch:
    image: nhsd/elasticsearch:$DOCKER_LIBRARY_ELASTICSEARCH_VERSION
    container_name: elasticsearch
    hostname: elasticsearch
    ports:
      - "9200:9200"
    command: ["elasticsearch"]
    networks:
      default:
        aliases:
          - elasticsearch.sfs.local

networks:
  default:
    external:
      name: $DOCKER_NETWORK
